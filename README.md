# Документация проекта KIWI.store

Проект **KIWI.store** – это полнофункциональный интернет-магазин, который включает в себя клиентскую часть для пользователей, административную панель для управления товарами и серверную часть для работы с базой данных и API. Документация описывает архитектуру, используемые технологии, структуру проекта и детали реализации каждой страницы.

---

## 1. Обзор проекта

**KIWI.store** представляет собой онлайн-магазин с современным дизайном и широким функционалом:

- **Пользовательская часть (Frontend):**
  - Главная страница с каталогом товаров.
  - Страницы входа и регистрации.
  - Личный кабинет с информацией о пользователе и историей заказов.
  - Страница с подробным описанием товара.
  - Корзина для оформления покупки.
  - Оформление заказа с выбором способа доставки и оплаты.
  - Страница подтверждения заказа.
  - Страница поддержки с FAQs и контактной информацией.

- **Административная панель:**
  - Страница для авторизации администратора.
  - Управление товарами: добавление, редактирование, удаление продуктов.

- **Серверная часть (Backend):**
  - Реализована на языке **Go** с использованием фреймворка [Gin](https://github.com/gin-gonic/gin).
  - API для регистрации, входа в систему, работы с товарами, корзиной и заказами.
  - Использование библиотеки [bcrypt](https://pkg.go.dev/golang.org/x/crypto/bcrypt) для безопасного хэширования паролей.
  - Работа с базой данных **SQLite** через пакет `database/sql` и драйвер `modernc.org/sqlite`.

---

## 2. Используемые технологии

- **Frontend:**  
  *HTML*, *CSS* и *JavaScript*  
  Используются современные подходы работы с DOM, CSS-анимации и адаптивная вёрстка.

- **Backend:**  
  *Go (Golang)* с фреймворком *Gin*  
  Обработка HTTP-запросов, маршрутизация, валидация данных и взаимодействие с базой данных.

- **База данных:**  
  *SQLite*  
  Файл `database.sqlite` содержит таблицы для пользователей, товаров, заказов, элементов корзины и пр.

---

## 3. Структура проекта

Проект имеет следующую структуру: 

```KIWI.store/
├── public/
│ ├── auth.js // Скрипты для аутентификации (регистрация, логин, логирование)
│ ├── login.html // Страница входа пользователя
│ ├── register.html // Страница регистрации нового пользователя
│ ├── admin_products.html // Административная панель для управления товарами
│ ├── cart.html // Страница корзины для оформления покупки
│ ├── checkout.html // Страница оформления заказа
│ ├── order_confirmation.html// Страница подтверждения заказа
│ ├── support.html // Страница поддержки и FAQ
│ ├── profile.html // Личный кабинет пользователя
│ └── product.html // Детальная карточка товара
├── images/ // Каталог для хранения изображений проекта
├── database.sqlite // Файл базы данных SQLite
└── main.go // Серверное приложение на Go
```
---

## 4. Описание клиентской части

### 4.1. HTML страницы

- **login.html**  
  Страница входа, где пользователь вводит email/никнейм и пароль. При отправке формы данные обрабатываются JavaScript-скриптом `auth.js`, который выполняет запрос к серверу для аутентификации.

- **register.html**  
  Страница регистрации, содержащая форму для ввода:
  - Email
  - Никнейма
  - Пароля
  - Подтверждения пароля  
  Производится валидация (например, проверка совпадения паролей, корректности формата email) и отправка POST-запроса на сервер. При успешной регистрации происходит редирект на страницу входа.

- **admin_products.html**  
  Административная панель:
  - Форма авторизации администратора (с сравнением введённого пароля с заданным значением).
  - После успешного входа отображается список товаров и форма для добавления нового товара, содержащая поля: название, описание, цена, изображение, платформа, жанр, разработчик, издатель, рейтинг, дата выхода, наличие на складе и скидка.

- **cart.html**  
  Страница корзины:
  - Таблица с товарами (изображение, название, цена, количество).
  - Возможно изменение количества или удаление товара.
  - Реализована возможность применения купонов для получения скидки.

- **checkout.html**  
  Страница оформления заказа:
  - Форма для выбора способа доставки и оплаты, а также ввода адреса и контактной информации.
  - По отправке формы происходит POST-запрос к API для оформления заказа; в ответ возвращается номер заказа.

- **order_confirmation.html**  
  Страница подтверждения:
  - Сообщение об успешном оформлении заказа.
  - Ссылки для возврата на главную страницу или перехода к поддержке.

- **support.html**  
  Страница поддержки:
  - Контактная информация: email, телефон.
  - Кнопка для начала чата (функциональность чата – заглушка на данный момент).
  - Раздел FAQ, в котором вопросы и ответы отображаются с анимацией.

- **profile.html**  
  Личный кабинет:
  - Отображение информации о пользователе: имя, email, телефон, адрес и дата регистрации.
  - Вкладка с историей заказов, где выводятся подробности каждого заказа.

- **product.html**  
  Детальная страница товара:
  - Отображение расширенной информации о товаре: название, описание, цена, изображения, рейтинг, отзывы.
  - Кнопка «Купить сейчас» добавляет товар в корзину, предварительно проверяя, авторизован ли пользователь.

### 4.2. JavaScript (auth.js)

Файл `auth.js` содержит логику для:

- **Регистрации:**
  - Получение значений из формы регистрации.
  - Валидация почты и проверка совпадения паролей.
  - Отправка POST-запроса на \`${API_BASE_URL}/api/register\` с данными пользователя.
  - Отображение сообщений об успехе или ошибках и редирект на страницу входа при успешной регистрации.

- **Логина:**
  - Обработка формы входа и валидация полей.
  - Если идентификатор содержит символ `@`, выполняется проверка корректности email.
  - Отправка POST-запроса на \`${API_BASE_URL}/api/login\`.
  - При удачном входе данные пользователя сохраняются в `localStorage` и выполняется редирект на целевую страницу (например, `test.html`).

- **Логирование действий:**
  - Переопределение функции `console.log` для отправки логов на сервер через \`${API_BASE_URL}/api/log\`.

---

## 5. Описание серверной части (main.go)

Приложение на Go реализовано с использованием фреймворка Gin и отвечает за:

- **Аутентификацию и регистрацию:**
  - Шифрование паролей с использованием библиотеки [bcrypt](https://pkg.go.dev/golang.org/x/crypto/bcrypt).
  - Хранение данных о пользователях в таблице `users` базы данных SQLite.

- **Работу с товарами:**
  - Обработчики для добавления, обновления и удаления товаров.
  - Пример функции добавления товара:
    ```go
    // addProductHandler - Добавляет новый товар (игру)
    func addProductHandler(db *sql.DB) gin.HandlerFunc {
    	return func(c *gin.Context) {
    		var prod Product
    		if err := c.ShouldBindJSON(&prod); err != nil {
    			c.JSON(http.StatusBadRequest, gin.H{"error": "Неверный формат запроса"})
    			return
    		}
    
    		query := `INSERT INTO products 
    			(name, description, price, image_url, platform, genre, developer, publisher, rating, release_date, stock, discount)
    			VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)`
    		res, err := db.Exec(query, prod.Name, prod.Description, prod.Price, prod.ImageURL,
    			prod.Platform, prod.Genre, prod.Developer, prod.Publisher, prod.Rating, prod.ReleaseDate, prod.Stock, prod.Discount)
    		if err != nil {
    			c.JSON(http.StatusInternalServerError, gin.H{"error": "Ошибка добавления товара: " + err.Error()})
    			return
    		}
    		id, _ := res.LastInsertId()
    		prod.ID = int(id)
    		c.JSON(http.StatusOK, gin.H{"success": true, "product": prod})
    	}
    }
    ```
    
- **Работу с заказами и корзиной:**
  - Обработка оформления заказа, составления списка товаров, а также применение купонов.
  - Возврат истории заказов для отображения в личном кабинете.

- **Загрузку медиафайлов:**
  - Обработчик загрузки файлов (изображений, видео). Файлы сохраняются в директорию `./public/uploads`, а клиент получает URL для доступа к загруженному контенту.

- **Взаимодействие с базой данных:**
  - Использование пакета `database/sql` и драйвера `modernc.org/sqlite` для выполнения SQL-запросов.

---

## 6. Запуск проекта

### 6.1. Установка зависимостей (Backend)

1. **Установите Go** (при необходимости скачайте с [официального сайта](https://golang.org/dl/)).

2. **Установка библиотек:**
   - Gin:
     ```bash
     go get -u github.com/gin-gonic/gin
     ```
   - bcrypt:
     ```bash
     go get golang.org/x/crypto/bcrypt
     ```
   - SQLite драйвер:
     ```bash
     go get modernc.org/sqlite
     ```

### 6.2. Запуск серверного приложения

Запустите сервер, находясь в директории проекта:

```bash
go run main.go
```

По умолчанию сервер запускается на порту **3000**.

### 6.3. Клиентская часть

- Разместите файлы из каталога `public` на вашем веб-сервере.
- Проверьте, чтобы переменная `API_BASE_URL` в файле `auth.js` указывала на правильный адрес API (например, `http://localhost:3000`).

---

## 7. Заключение

Проект **KIWI.store** объединяет современные веб-технологии для создания удобного и функционального интернет-магазина. Структурированное разделение клиентской и серверной логики обеспечивает масштабируемость и простоту поддержки.  
При дальнейшей разработке рекомендуется уделить особое внимание безопасности (особенно в административном интерфейсе) и оптимизации работы с базой данных.

Эта документация предназначена для разработчиков, администраторов и всех заинтересованных сторон, и может быть дополнена по мере развития проекта.

---


